/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package A3_EXAM;

import A3_EXAM.model.database.FoodAndNutritionDbImpl;
import A3_EXAM.model.api.edamam.FoodDatabaseActualApi;
import A3_EXAM.model.api.edamam.FoodDatabaseDummyApi;
import A3_EXAM.model.api.imgur.ImgurActualApi;
import A3_EXAM.model.api.imgur.ImgurDummyApi;
import A3_EXAM.model.dataobject.FoodItemNutrientData;

import A3_EXAM.model.facade.ModelFacade;
import A3_EXAM.model.facade.ModelFacadeImpl;
import A3_EXAM.model.parsers.JSONParser;
import A3_EXAM.model.parsers.JSONParserImpl;
import A3_EXAM.model.parsers.ReportParser;
import A3_EXAM.model.parsers.ReportParserImpl;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.ArgumentCaptor;
import org.mockito.Mock;
import org.mockito.junit.MockitoJUnitRunner;
import java.util.ArrayList;

import static org.junit.Assert.*;
import static org.mockito.Mockito.*;
import static org.mockito.Mockito.atLeast;

@RunWith(MockitoJUnitRunner.class)


public class TestGenerateAndUploadReportFunctionality {

    private ModelFacade model;
    private JSONParser jsonParser;
    private ReportParser reportParserImpl;
    @Mock private ImgurActualApi imgurApi;
    @Mock private ImgurDummyApi imgurDummyApi;
    @Mock private FoodDatabaseActualApi foodApi;
    @Mock private FoodDatabaseDummyApi foodDummyApi;
    @Mock private FoodAndNutritionDbImpl db;

    @Before
    public void setup() {
        jsonParser = new JSONParserImpl();
        reportParserImpl = new ReportParserImpl();
        model = new ModelFacadeImpl(foodApi, imgurApi, db, jsonParser, reportParserImpl);
    }

    @Test
    public void testPrepareNutritionReportDataForItemThatAlternatelyDoesAndDoesNotExceedMaxCalories() {

        model = new ModelFacadeImpl(foodDummyApi, imgurApi, db, jsonParser, reportParserImpl);


        lenient().when(foodDummyApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_bk6goo7bkb4utbajbrx1lav6e0vm")).thenReturn("{\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\",\"calories\" : 140,\"totalWeight\" : 28.0,\"dietLabels\" : [ ],\"healthLabels\" : [ \"VEGETARIAN\", \"PESCATARIAN\", \"GLUTEN_FREE\", \"WHEAT_FREE\", \"EGG_FREE\", \"TREE_NUT_FREE\", \"FISH_FREE\", \"SHELLFISH_FREE\", \"PORK_FREE\", \"RED_MEAT_FREE\", \"CRUSTACEAN_FREE\", \"CELERY_FREE\", \"MUSTARD_FREE\", \"SESAME_FREE\", \"LUPINE_FREE\", \"MOLLUSK_FREE\", \"ALCOHOL_FREE\", \"KOSHER\" ],\"cautions\" : [ \"SULFITES\" ],\"totalNutrients\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 140.0,\"unit\" : \"kcal\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 9.000000000000002,\"unit\" : \"g\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 1.5000000000000002,\"unit\" : \"g\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 16.000000000000004,\"unit\" : \"g\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"SUGAR\" : {\"label\" : \"Sugars\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 2.0000000000000004,\"unit\" : \"g\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"mg\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 240.00000000000006,\"unit\" : \"mg\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 20.000000000000004,\"unit\" : \"mg\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 0.3600000143051148,\"unit\" : \"mg\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 4.800000190734864,\"unit\" : \"mg\"}},\"totalDaily\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 7.0,\"unit\" : \"%\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 13.84615384615385,\"unit\" : \"%\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 7.500000000000002,\"unit\" : \"%\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 5.333333333333335,\"unit\" : \"%\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"%\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 10.000000000000004,\"unit\" : \"%\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 2.0000000000000004,\"unit\" : \"%\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 2.0000000794728603,\"unit\" : \"%\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 5.3333335452609605,\"unit\" : \"%\"}},\"ingredients\" : [ {\"parsed\" : [ {\"quantity\" : 1.0,\"measure\" : \"serving\",\"food\" : \"Doritos - Jacked Test Flavor - 2 Blue\",\"foodId\" : \"food_bk6goo7bkb4utbajbrx1lav6e0vm\",\"foodContentsLabel\" : \"Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt; Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures; Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey; Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate And Guanylate.\",\"weight\" : 28.0,\"retainedWeight\" : 28.0,\"servingSizes\" : [ {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\" : \"Gram\",\"quantity\" : 28.0}, {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_chip\",\"label\" : \"Chip\",\"quantity\" : 13.0} ],\"servingsPerContainer\" : 1.0,\"measureURI\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\" : \"OK\"} ]} ]}\n");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_bk6goo7bkb4utbajbrx1lav6e0vm");

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);

        String e = "Nutritional facts for 'Doritos - Jacked Test Flavor - 2 Blue'\n" +
                "\n" +
                "Amount per serving (Weight of 28 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 140 kcal\n" +
                "Protein: 2 g\n" +
                "Fat\n" +
                "\tTotal: 9 g\n" +
                "\tSaturated: 1.5 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 16 g\n" +
                "\tSugars: 1 g\n" +
                "Fiber: 1 g\n" +
                "Sodium: 240 mg\n" +
                "Cholesterol: 0 mg\n" +
                "Vitamin C: 4.8 mg\n" +
                "Calcium: 20 mg\n" +
                "Iron: 0.36 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 7 %\n" +
                "Protein: 4 %\n" +
                "Fat\n" +
                "\tTotal: 13.85 %\n" +
                "\tSaturated: 7.5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 5.33 %\n" +
                "Fiber: 4 %\n" +
                "Sodium: 10 %\n" +
                "Cholesterol: 0 %\n" +
                "Vitamin C: 5.33 %\n" +
                "Calcium: 2 %\n" +
                "Iron: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Sulfites\n" +
                "\n" +
                "***Health labels***\n" +
                "Vegetarian, Pescatarian, Gluten free, Wheat free, Egg free, Tree nut free,\n" +
                "Fish free, Shellfish free, Pork free, Red meat free, Crustacean free,\n" +
                "Celery free, Mustard free, Sesame free, Lupine free, Mollusk free, Alcohol\n" +
                "free, Kosher\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt;\n" +
                "Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures;\n" +
                "Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey;\n" +
                "Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate\n" +
                "And Guanylate.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_bk6goo7bkb4utbajbrx1lav6e0vm\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        ArgumentCaptor<String> argumentCaptor = ArgumentCaptor.forClass(String.class);
        verify(imgurApi).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), e);

        model.updateFoodItemExceedsMaxCalories(true);
        assertTrue(model.checkFoodItemExceedsMaxCalories());

        String e2 = "*" + e;
        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        verify(imgurApi, atLeast(1)).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), e2);

        model.updateFoodItemExceedsMaxCalories(false);
        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        verify(imgurApi, atLeast(1)).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), e);

        model.updateFoodItemExceedsMaxCalories(true);
        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        verify(imgurApi, atLeast(1)).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), e2);

    }

    @Test
    public void testPrepareNutritionReportDataForItemExceedingMaxCalories() {

        lenient().when(foodApi.foodSearchRequest("pho bo")).thenReturn("{\"text\":\"pho bo\",\"parsed\":[]," +
                "\"hints\":[{\"food\":{\"foodId\":\"food_aqbqwiabyu8z3na7wx75yadbpbuv\",\"label\":\"Pho bo, Vietnamese Beef Noodle Soup Recipes\",\"nutrients\":{\"ENERC_KCAL\":118.5878310328453,\"PROCNT\":5.660732600854679,\"FAT\":8.579647168640978,\"CHOCDF\":4.407222110668033,\"FIBTG\":0.25267015516000774},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef short ribs; water; star anise; cinnamon stick; cloves; black peppercorns; ginger; onions; stewing beef; fish sauce; Salt; rice noodles; bean sprouts; lean beef; basil; coriander leaves; shallots; serrano chiles; lime\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"label\":\"Vietnamese Pho Rice Noodle Soup, Pho bo, Beef Flavor\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"image\":\"https://www.edamam.com/food-img/f92/f929fad67cc61733dccb46dae7a1e4c1.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_br8zzy9b0pupd5acnhv29aiiroai\",\"label\":\"Vifon - Vietnamese Pho bo Beef Flavor Rice Noodle Soup\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_afnegfaaxxs20fa1fxv9ba63s1bl\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":266,\"PROCNT\":26.97,\"FAT\":16.77,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/820/82060c5546b5506157eb10222347addc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b643lm2ab9no7gavlyg5ia9xp383\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":282,\"PROCNT\":25.93,\"FAT\":18.95,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/e56/e5626879784fa813b00f38756e1f3b86.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_butzgzba9cz1ftbl6tvnoaegg8js\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":218,\"PROCNT\":30.32,\"FAT\":9.8,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/9fc/9fc964935fecb04094e072dd291202fc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_a0jwudwaa9jj7yaa098yqa6tfwu4\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":113,\"PROCNT\":19.15,\"FAT\":3.48,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/178/178221c82a2b82c93433e0c8c66e2242.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_knuckle\",\"label\":\"Knuckle\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"}]},{\"food\":{\"foodId\":\"food_aw94iunbzrlowaa01nlupb4pslrx\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":191,\"PROCNT\":31.54,\"FAT\":6.2,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/cda/cdac66c34acd19e8bcb6fd4119aa9ddb.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bwsm76yamlt954bvsjs9ca33hf5f\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":291,\"PROCNT\":17.32,\"FAT\":24.05,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/5ee/5eef785c09133fb4a4199fda2ff61060.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bg9hn02b2sbwy1btvvp2xbyqqkvh\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":144,\"PROCNT\":19.35,\"FAT\":6.77,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cutlet\",\"label\":\"Cutlet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_fillet\",\"label\":\"Fillet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_chop\",\"label\":\"Chop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rump\",\"label\":\"Rump\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_loin\",\"label\":\"Loin\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_roast\",\"label\":\"Roast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_scallop\",\"label\":\"Scallop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rib\",\"label\":\"Rib\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_medallion\",\"label\":\"Medallion\"}]},{\"food\":{\"foodId\":\"food_bduaejrbd3vj2wb74qeryb9ac11p\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":521,\"PROCNT\":9.4,\"FAT\":53.35,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/3ff/3ff13fd12b11d397fa204469a8dda5fe.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bx60i9ob54yw7gbxaowzvay6fgo3\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":208,\"PROCNT\":17.47,\"FAT\":14.75,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7ee/7eeac59d0cc5263fa9794cccf094db51.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_breast\",\"label\":\"Breast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_brisket\",\"label\":\"Brisket\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"}]},{\"food\":{\"foodId\":\"food_bxy66nga9w9csxb3vse7vbjasbub\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":248,\"PROCNT\":28.23,\"FAT\":14.16,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7f9/7f9946fc0b0995390d148d782fb8578f.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_baz1qzvbxlxtzta24ngw9bkpm2eu\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":108,\"PROCNT\":19.28,\"FAT\":2.83,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/058/058d64c5c23a2a3580979815aab2d3ec.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_aidmp07a17eq1za8qu3dvauczx0k\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":177,\"PROCNT\":32.22,\"FAT\":4.33,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/4e3/4e3d2dc9bb0b9819c4c1355409959790.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b887gfwbugptp8b4ax7e8bpkc42a\",\"label\":\"Beef Pho\",\"nutrients\":{\"ENERC_KCAL\":72.56406882273347,\"PROCNT\":4.126439591930957,\"FAT\":1.881151653787706,\"CHOCDF\":9.805526808494994,\"FIBTG\":0.6989607423082591},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"piece ginger; garlic; shallot; beef stock; star anise; cinnamon; fish sauce; palm sugar; rice noodles; white onion; beef fillet; black pepper; bean sprouts; chilies; Thai basil; mint leaves\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bkxmwwebwo95dna0j5mv0bxkstqc\",\"label\":\"Faux Pho\",\"nutrients\":{\"ENERC_KCAL\":69.73453580183781,\"PROCNT\":4.009046642202151,\"FAT\":1.9768611062005457,\"CHOCDF\":8.97026883740962,\"FIBTG\":0.6699134516278402},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"rice sticks; snow peas; vegetable oil; shallots; ginger; serrano chile; beef stock; broth; water; rare roast beef; bean sprouts; cilantro; fresh basil; mint; fish sauce; lime juice; salt\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_apzw6q8azq6ujpapw661gbndrmcz\",\"label\":\"Turkey Pho\",\"nutrients\":{\"ENERC_KCAL\":130.88091049835262,\"PROCNT\":4.38362581696519,\"FAT\":1.6862862928418778,\"CHOCDF\":24.42057572396058,\"FIBTG\":0.7628931247321398},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"coriander seeds; cloves; star anise; cinnamon stick; turkey stock; green onions; ginger; brown sugar; fish sauce; kale; turkey breast; bean thread noodles; lime; Sriracha\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bh5twobasevqefb2rf12bb2xq810\",\"label\":\"Vietnamese Pho\",\"nutrients\":{\"ENERC_KCAL\":67.46051231305492,\"PROCNT\":3.5483275815495334,\"FAT\":1.1407679506189536,\"CHOCDF\":10.639879708017723,\"FIBTG\":0.5158907952835058},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef stock; onion; ginger; cloves; black peppercorns; cinnamon stick; beef sirloin steak; hoisin sauce; fish sauce; red chillies; spring onions; fresh coriander; lime; rice noodles\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bfdmpupbzn2n6gadmplhab75x7w3\",\"label\":\"Pho\",\"nutrients\":{\"ENERC_KCAL\":112.28533685601057,\"PROCNT\":4.227212681638045,\"FAT\":0.7926023778071335,\"CHOCDF\":22.324966974900928,\"FIBTG\":0.7926023778071335},\"brand\":\"Earl's\",\"category\":\"Fast foods\",\"categoryLabel\":\"meal\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]}],\"_links\":{\"next\":{\"title\":\"Next page\",\"href\":\"https://api.edamam.com/api/food-database/parser?session=40&app_id=5c8fcc57&app_key=8f2e80cbb28dfcb8ed8b9411d42426eb&ingr=pho+bo\"}}}");

        lenient().when(foodApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_ax9o3jjbybptbrbzwdbrean5cg4v")).thenReturn("{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\",\"calories\":250,\"totalWeight\":68.03885820362122,\"dietLabels\":[],\"healthLabels\":[\"EGG_FREE\",\"PEANUT_FREE\",\"TREE_NUT_FREE\",\"SOY_FREE\",\"FISH_FREE\",\"SHELLFISH_FREE\",\"PORK_FREE\",\"CRUSTACEAN_FREE\",\"CELERY_FREE\",\"MUSTARD_FREE\",\"SESAME_FREE\",\"LUPINE_FREE\",\"MOLLUSK_FREE\",\"ALCOHOL_FREE\"],\"cautions\":[\"GLUTEN\",\"WHEAT\",\"SULFITES\",\"FODMAP\"],\"totalNutrients\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":250.99999999999997,\"unit\":\"kcal\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":3,\"unit\":\"g\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":1,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":51,\"unit\":\"g\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.10000000149011612,\"unit\":\"g\"},\"SUGAR\":{\"label\":\"Sugars\",\"quantity\":3,\"unit\":\"g\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":6,\"unit\":\"g\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":6,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":2142,\"unit\":\"mg\"}},\"totalDaily\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":12.549999999999999,\"unit\":\"%\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":4.615384615384615,\"unit\":\"%\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":5,\"unit\":\"%\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":17,\"unit\":\"%\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.4000000059604645,\"unit\":\"%\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":12,\"unit\":\"%\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":2,\"unit\":\"%\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":89.25,\"unit\":\"%\"}},\"ingredients\":[{\"parsed\":[{\"quantity\":1,\"measure\":\"serving\",\"food\":\"Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor\",\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"weight\":68.03885820362122,\"retainedWeight\":68.03885820362122,\"servingSizes\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\",\"quantity\":2.4000000953674316},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\",\"quantity\":70}],\"servingsPerContainer\":1,\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\":\"OK\"}]}]}");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_ax9o3jjbybptbrbzwdbrean5cg4v");

        assertFalse(model.checkFoodItemExceedsMaxCalories());
        model.updateFoodItemExceedsMaxCalories(true);

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);
        assertNotNull(data);

        String expectedReportData = "*Nutritional facts for 'Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor'\n" +
                "\n" +
                "Amount per serving (Weight of 68.04 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 251 kcal\n" +
                "Protein: 6 g\n" +
                "Fat\n" +
                "\tTotal: 3 g\n" +
                "\tSaturated: 1 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 51 g\n" +
                "\tSugars: 3 g\n" +
                "Fiber: 0.1 g\n" +
                "Sodium: 2142 mg\n" +
                "Cholesterol: 6 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 12.55 %\n" +
                "Protein: 12 %\n" +
                "Fat\n" +
                "\tTotal: 4.62 %\n" +
                "\tSaturated: 5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 17 %\n" +
                "Fiber: 0.4 %\n" +
                "Sodium: 89.25 %\n" +
                "Cholesterol: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Gluten, Wheat, Sulfites, Fodmap\n" +
                "\n" +
                "***Health labels***\n" +
                "Egg free, Peanut free, Tree nut free, Soy free, Fish free, Shellfish free,\n" +
                "Pork free, Crustacean free, Celery free, Mustard free, Sesame free, Lupine\n" +
                "free, Mollusk free, Alcohol free\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat\n" +
                "Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup\n" +
                "Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion;\n" +
                "Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce :\n" +
                "Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_ax9o3jjbybptbrbzwdbrean5cg4v\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";


        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        ArgumentCaptor<String> argumentCaptor = ArgumentCaptor.forClass(String.class);
        verify(imgurApi).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), expectedReportData);

    }

    @Test
    public void testPrepareNutritionReportDataForItemBelowMaxCalories() {

        lenient().when(foodApi.foodSearchRequest("pho bo")).thenReturn("{\"text\":\"pho bo\",\"parsed\":[]," +
                "\"hints\":[{\"food\":{\"foodId\":\"food_aqbqwiabyu8z3na7wx75yadbpbuv\",\"label\":\"Pho bo, Vietnamese Beef Noodle Soup Recipes\",\"nutrients\":{\"ENERC_KCAL\":118.5878310328453,\"PROCNT\":5.660732600854679,\"FAT\":8.579647168640978,\"CHOCDF\":4.407222110668033,\"FIBTG\":0.25267015516000774},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef short ribs; water; star anise; cinnamon stick; cloves; black peppercorns; ginger; onions; stewing beef; fish sauce; Salt; rice noodles; bean sprouts; lean beef; basil; coriander leaves; shallots; serrano chiles; lime\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"label\":\"Vietnamese Pho Rice Noodle Soup, Pho bo, Beef Flavor\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"image\":\"https://www.edamam.com/food-img/f92/f929fad67cc61733dccb46dae7a1e4c1.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_br8zzy9b0pupd5acnhv29aiiroai\",\"label\":\"Vifon - Vietnamese Pho bo Beef Flavor Rice Noodle Soup\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_afnegfaaxxs20fa1fxv9ba63s1bl\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":266,\"PROCNT\":26.97,\"FAT\":16.77,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/820/82060c5546b5506157eb10222347addc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b643lm2ab9no7gavlyg5ia9xp383\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":282,\"PROCNT\":25.93,\"FAT\":18.95,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/e56/e5626879784fa813b00f38756e1f3b86.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_butzgzba9cz1ftbl6tvnoaegg8js\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":218,\"PROCNT\":30.32,\"FAT\":9.8,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/9fc/9fc964935fecb04094e072dd291202fc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_a0jwudwaa9jj7yaa098yqa6tfwu4\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":113,\"PROCNT\":19.15,\"FAT\":3.48,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/178/178221c82a2b82c93433e0c8c66e2242.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_knuckle\",\"label\":\"Knuckle\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"}]},{\"food\":{\"foodId\":\"food_aw94iunbzrlowaa01nlupb4pslrx\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":191,\"PROCNT\":31.54,\"FAT\":6.2,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/cda/cdac66c34acd19e8bcb6fd4119aa9ddb.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bwsm76yamlt954bvsjs9ca33hf5f\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":291,\"PROCNT\":17.32,\"FAT\":24.05,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/5ee/5eef785c09133fb4a4199fda2ff61060.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bg9hn02b2sbwy1btvvp2xbyqqkvh\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":144,\"PROCNT\":19.35,\"FAT\":6.77,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cutlet\",\"label\":\"Cutlet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_fillet\",\"label\":\"Fillet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_chop\",\"label\":\"Chop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rump\",\"label\":\"Rump\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_loin\",\"label\":\"Loin\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_roast\",\"label\":\"Roast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_scallop\",\"label\":\"Scallop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rib\",\"label\":\"Rib\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_medallion\",\"label\":\"Medallion\"}]},{\"food\":{\"foodId\":\"food_bduaejrbd3vj2wb74qeryb9ac11p\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":521,\"PROCNT\":9.4,\"FAT\":53.35,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/3ff/3ff13fd12b11d397fa204469a8dda5fe.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bx60i9ob54yw7gbxaowzvay6fgo3\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":208,\"PROCNT\":17.47,\"FAT\":14.75,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7ee/7eeac59d0cc5263fa9794cccf094db51.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_breast\",\"label\":\"Breast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_brisket\",\"label\":\"Brisket\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"}]},{\"food\":{\"foodId\":\"food_bxy66nga9w9csxb3vse7vbjasbub\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":248,\"PROCNT\":28.23,\"FAT\":14.16,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7f9/7f9946fc0b0995390d148d782fb8578f.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_baz1qzvbxlxtzta24ngw9bkpm2eu\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":108,\"PROCNT\":19.28,\"FAT\":2.83,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/058/058d64c5c23a2a3580979815aab2d3ec.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_aidmp07a17eq1za8qu3dvauczx0k\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":177,\"PROCNT\":32.22,\"FAT\":4.33,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/4e3/4e3d2dc9bb0b9819c4c1355409959790.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b887gfwbugptp8b4ax7e8bpkc42a\",\"label\":\"Beef Pho\",\"nutrients\":{\"ENERC_KCAL\":72.56406882273347,\"PROCNT\":4.126439591930957,\"FAT\":1.881151653787706,\"CHOCDF\":9.805526808494994,\"FIBTG\":0.6989607423082591},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"piece ginger; garlic; shallot; beef stock; star anise; cinnamon; fish sauce; palm sugar; rice noodles; white onion; beef fillet; black pepper; bean sprouts; chilies; Thai basil; mint leaves\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bkxmwwebwo95dna0j5mv0bxkstqc\",\"label\":\"Faux Pho\",\"nutrients\":{\"ENERC_KCAL\":69.73453580183781,\"PROCNT\":4.009046642202151,\"FAT\":1.9768611062005457,\"CHOCDF\":8.97026883740962,\"FIBTG\":0.6699134516278402},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"rice sticks; snow peas; vegetable oil; shallots; ginger; serrano chile; beef stock; broth; water; rare roast beef; bean sprouts; cilantro; fresh basil; mint; fish sauce; lime juice; salt\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_apzw6q8azq6ujpapw661gbndrmcz\",\"label\":\"Turkey Pho\",\"nutrients\":{\"ENERC_KCAL\":130.88091049835262,\"PROCNT\":4.38362581696519,\"FAT\":1.6862862928418778,\"CHOCDF\":24.42057572396058,\"FIBTG\":0.7628931247321398},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"coriander seeds; cloves; star anise; cinnamon stick; turkey stock; green onions; ginger; brown sugar; fish sauce; kale; turkey breast; bean thread noodles; lime; Sriracha\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bh5twobasevqefb2rf12bb2xq810\",\"label\":\"Vietnamese Pho\",\"nutrients\":{\"ENERC_KCAL\":67.46051231305492,\"PROCNT\":3.5483275815495334,\"FAT\":1.1407679506189536,\"CHOCDF\":10.639879708017723,\"FIBTG\":0.5158907952835058},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef stock; onion; ginger; cloves; black peppercorns; cinnamon stick; beef sirloin steak; hoisin sauce; fish sauce; red chillies; spring onions; fresh coriander; lime; rice noodles\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bfdmpupbzn2n6gadmplhab75x7w3\",\"label\":\"Pho\",\"nutrients\":{\"ENERC_KCAL\":112.28533685601057,\"PROCNT\":4.227212681638045,\"FAT\":0.7926023778071335,\"CHOCDF\":22.324966974900928,\"FIBTG\":0.7926023778071335},\"brand\":\"Earl's\",\"category\":\"Fast foods\",\"categoryLabel\":\"meal\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]}],\"_links\":{\"next\":{\"title\":\"Next page\",\"href\":\"https://api.edamam.com/api/food-database/parser?session=40&app_id=5c8fcc57&app_key=8f2e80cbb28dfcb8ed8b9411d42426eb&ingr=pho+bo\"}}}");

        lenient().when(foodApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_ax9o3jjbybptbrbzwdbrean5cg4v")).thenReturn("{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\",\"calories\":250,\"totalWeight\":68.03885820362122,\"dietLabels\":[],\"healthLabels\":[\"EGG_FREE\",\"PEANUT_FREE\",\"TREE_NUT_FREE\",\"SOY_FREE\",\"FISH_FREE\",\"SHELLFISH_FREE\",\"PORK_FREE\",\"CRUSTACEAN_FREE\",\"CELERY_FREE\",\"MUSTARD_FREE\",\"SESAME_FREE\",\"LUPINE_FREE\",\"MOLLUSK_FREE\",\"ALCOHOL_FREE\"],\"cautions\":[\"GLUTEN\",\"WHEAT\",\"SULFITES\",\"FODMAP\"],\"totalNutrients\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":250.99999999999997,\"unit\":\"kcal\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":3,\"unit\":\"g\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":1,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":51,\"unit\":\"g\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.10000000149011612,\"unit\":\"g\"},\"SUGAR\":{\"label\":\"Sugars\",\"quantity\":3,\"unit\":\"g\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":6,\"unit\":\"g\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":6,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":2142,\"unit\":\"mg\"}},\"totalDaily\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":12.549999999999999,\"unit\":\"%\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":4.615384615384615,\"unit\":\"%\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":5,\"unit\":\"%\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":17,\"unit\":\"%\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.4000000059604645,\"unit\":\"%\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":12,\"unit\":\"%\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":2,\"unit\":\"%\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":89.25,\"unit\":\"%\"}},\"ingredients\":[{\"parsed\":[{\"quantity\":1,\"measure\":\"serving\",\"food\":\"Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor\",\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"weight\":68.03885820362122,\"retainedWeight\":68.03885820362122,\"servingSizes\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\",\"quantity\":2.4000000953674316},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\",\"quantity\":70}],\"servingsPerContainer\":1,\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\":\"OK\"}]}]}");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_ax9o3jjbybptbrbzwdbrean5cg4v");

        assertFalse(model.checkFoodItemExceedsMaxCalories());

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);
        assertNotNull(data);

        String expectedReportData = "Nutritional facts for 'Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor'\n" +
                "\n" +
                "Amount per serving (Weight of 68.04 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 251 kcal\n" +
                "Protein: 6 g\n" +
                "Fat\n" +
                "\tTotal: 3 g\n" +
                "\tSaturated: 1 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 51 g\n" +
                "\tSugars: 3 g\n" +
                "Fiber: 0.1 g\n" +
                "Sodium: 2142 mg\n" +
                "Cholesterol: 6 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 12.55 %\n" +
                "Protein: 12 %\n" +
                "Fat\n" +
                "\tTotal: 4.62 %\n" +
                "\tSaturated: 5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 17 %\n" +
                "Fiber: 0.4 %\n" +
                "Sodium: 89.25 %\n" +
                "Cholesterol: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Gluten, Wheat, Sulfites, Fodmap\n" +
                "\n" +
                "***Health labels***\n" +
                "Egg free, Peanut free, Tree nut free, Soy free, Fish free, Shellfish free,\n" +
                "Pork free, Crustacean free, Celery free, Mustard free, Sesame free, Lupine\n" +
                "free, Mollusk free, Alcohol free\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat\n" +
                "Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup\n" +
                "Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion;\n" +
                "Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce :\n" +
                "Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_ax9o3jjbybptbrbzwdbrean5cg4v\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        model.uploadNutritionReportAndGetURL(model.prepareNutritionReportData(data));
        ArgumentCaptor<String> argumentCaptor = ArgumentCaptor.forClass(String.class);
        verify(imgurApi).uploadNutritionReportToImgur(argumentCaptor.capture());
        assertEquals(argumentCaptor.getValue(), expectedReportData);

    }

    @Test
    public void testPrepareNutritionReportData() {

        lenient().when(foodApi.foodSearchRequest("pho bo")).thenReturn("{\"text\":\"pho bo\",\"parsed\":[]," +
                "\"hints\":[{\"food\":{\"foodId\":\"food_aqbqwiabyu8z3na7wx75yadbpbuv\",\"label\":\"Pho bo, Vietnamese Beef Noodle Soup Recipes\",\"nutrients\":{\"ENERC_KCAL\":118.5878310328453,\"PROCNT\":5.660732600854679,\"FAT\":8.579647168640978,\"CHOCDF\":4.407222110668033,\"FIBTG\":0.25267015516000774},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef short ribs; water; star anise; cinnamon stick; cloves; black peppercorns; ginger; onions; stewing beef; fish sauce; Salt; rice noodles; bean sprouts; lean beef; basil; coriander leaves; shallots; serrano chiles; lime\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"label\":\"Vietnamese Pho Rice Noodle Soup, Pho bo, Beef Flavor\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"image\":\"https://www.edamam.com/food-img/f92/f929fad67cc61733dccb46dae7a1e4c1.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_br8zzy9b0pupd5acnhv29aiiroai\",\"label\":\"Vifon - Vietnamese Pho bo Beef Flavor Rice Noodle Soup\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_afnegfaaxxs20fa1fxv9ba63s1bl\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":266,\"PROCNT\":26.97,\"FAT\":16.77,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/820/82060c5546b5506157eb10222347addc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b643lm2ab9no7gavlyg5ia9xp383\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":282,\"PROCNT\":25.93,\"FAT\":18.95,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/e56/e5626879784fa813b00f38756e1f3b86.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_butzgzba9cz1ftbl6tvnoaegg8js\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":218,\"PROCNT\":30.32,\"FAT\":9.8,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/9fc/9fc964935fecb04094e072dd291202fc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_a0jwudwaa9jj7yaa098yqa6tfwu4\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":113,\"PROCNT\":19.15,\"FAT\":3.48,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/178/178221c82a2b82c93433e0c8c66e2242.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_knuckle\",\"label\":\"Knuckle\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"}]},{\"food\":{\"foodId\":\"food_aw94iunbzrlowaa01nlupb4pslrx\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":191,\"PROCNT\":31.54,\"FAT\":6.2,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/cda/cdac66c34acd19e8bcb6fd4119aa9ddb.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bwsm76yamlt954bvsjs9ca33hf5f\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":291,\"PROCNT\":17.32,\"FAT\":24.05,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/5ee/5eef785c09133fb4a4199fda2ff61060.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bg9hn02b2sbwy1btvvp2xbyqqkvh\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":144,\"PROCNT\":19.35,\"FAT\":6.77,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cutlet\",\"label\":\"Cutlet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_fillet\",\"label\":\"Fillet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_chop\",\"label\":\"Chop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rump\",\"label\":\"Rump\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_loin\",\"label\":\"Loin\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_roast\",\"label\":\"Roast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_scallop\",\"label\":\"Scallop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rib\",\"label\":\"Rib\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_medallion\",\"label\":\"Medallion\"}]},{\"food\":{\"foodId\":\"food_bduaejrbd3vj2wb74qeryb9ac11p\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":521,\"PROCNT\":9.4,\"FAT\":53.35,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/3ff/3ff13fd12b11d397fa204469a8dda5fe.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bx60i9ob54yw7gbxaowzvay6fgo3\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":208,\"PROCNT\":17.47,\"FAT\":14.75,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7ee/7eeac59d0cc5263fa9794cccf094db51.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_breast\",\"label\":\"Breast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_brisket\",\"label\":\"Brisket\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"}]},{\"food\":{\"foodId\":\"food_bxy66nga9w9csxb3vse7vbjasbub\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":248,\"PROCNT\":28.23,\"FAT\":14.16,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7f9/7f9946fc0b0995390d148d782fb8578f.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_baz1qzvbxlxtzta24ngw9bkpm2eu\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":108,\"PROCNT\":19.28,\"FAT\":2.83,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/058/058d64c5c23a2a3580979815aab2d3ec.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_aidmp07a17eq1za8qu3dvauczx0k\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":177,\"PROCNT\":32.22,\"FAT\":4.33,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/4e3/4e3d2dc9bb0b9819c4c1355409959790.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b887gfwbugptp8b4ax7e8bpkc42a\",\"label\":\"Beef Pho\",\"nutrients\":{\"ENERC_KCAL\":72.56406882273347,\"PROCNT\":4.126439591930957,\"FAT\":1.881151653787706,\"CHOCDF\":9.805526808494994,\"FIBTG\":0.6989607423082591},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"piece ginger; garlic; shallot; beef stock; star anise; cinnamon; fish sauce; palm sugar; rice noodles; white onion; beef fillet; black pepper; bean sprouts; chilies; Thai basil; mint leaves\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bkxmwwebwo95dna0j5mv0bxkstqc\",\"label\":\"Faux Pho\",\"nutrients\":{\"ENERC_KCAL\":69.73453580183781,\"PROCNT\":4.009046642202151,\"FAT\":1.9768611062005457,\"CHOCDF\":8.97026883740962,\"FIBTG\":0.6699134516278402},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"rice sticks; snow peas; vegetable oil; shallots; ginger; serrano chile; beef stock; broth; water; rare roast beef; bean sprouts; cilantro; fresh basil; mint; fish sauce; lime juice; salt\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_apzw6q8azq6ujpapw661gbndrmcz\",\"label\":\"Turkey Pho\",\"nutrients\":{\"ENERC_KCAL\":130.88091049835262,\"PROCNT\":4.38362581696519,\"FAT\":1.6862862928418778,\"CHOCDF\":24.42057572396058,\"FIBTG\":0.7628931247321398},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"coriander seeds; cloves; star anise; cinnamon stick; turkey stock; green onions; ginger; brown sugar; fish sauce; kale; turkey breast; bean thread noodles; lime; Sriracha\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bh5twobasevqefb2rf12bb2xq810\",\"label\":\"Vietnamese Pho\",\"nutrients\":{\"ENERC_KCAL\":67.46051231305492,\"PROCNT\":3.5483275815495334,\"FAT\":1.1407679506189536,\"CHOCDF\":10.639879708017723,\"FIBTG\":0.5158907952835058},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef stock; onion; ginger; cloves; black peppercorns; cinnamon stick; beef sirloin steak; hoisin sauce; fish sauce; red chillies; spring onions; fresh coriander; lime; rice noodles\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bfdmpupbzn2n6gadmplhab75x7w3\",\"label\":\"Pho\",\"nutrients\":{\"ENERC_KCAL\":112.28533685601057,\"PROCNT\":4.227212681638045,\"FAT\":0.7926023778071335,\"CHOCDF\":22.324966974900928,\"FIBTG\":0.7926023778071335},\"brand\":\"Earl's\",\"category\":\"Fast foods\",\"categoryLabel\":\"meal\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]}],\"_links\":{\"next\":{\"title\":\"Next page\",\"href\":\"https://api.edamam.com/api/food-database/parser?session=40&app_id=5c8fcc57&app_key=8f2e80cbb28dfcb8ed8b9411d42426eb&ingr=pho+bo\"}}}");

        lenient().when(foodApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_ax9o3jjbybptbrbzwdbrean5cg4v")).thenReturn("{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\",\"calories\":250,\"totalWeight\":68.03885820362122,\"dietLabels\":[],\"healthLabels\":[\"EGG_FREE\",\"PEANUT_FREE\",\"TREE_NUT_FREE\",\"SOY_FREE\",\"FISH_FREE\",\"SHELLFISH_FREE\",\"PORK_FREE\",\"CRUSTACEAN_FREE\",\"CELERY_FREE\",\"MUSTARD_FREE\",\"SESAME_FREE\",\"LUPINE_FREE\",\"MOLLUSK_FREE\",\"ALCOHOL_FREE\"],\"cautions\":[\"GLUTEN\",\"WHEAT\",\"SULFITES\",\"FODMAP\"],\"totalNutrients\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":250.99999999999997,\"unit\":\"kcal\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":3,\"unit\":\"g\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":1,\"unit\":\"g\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":51,\"unit\":\"g\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.10000000149011612,\"unit\":\"g\"},\"SUGAR\":{\"label\":\"Sugars\",\"quantity\":3,\"unit\":\"g\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":6,\"unit\":\"g\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":6,\"unit\":\"mg\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":2142,\"unit\":\"mg\"}},\"totalDaily\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":12.549999999999999,\"unit\":\"%\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":4.615384615384615,\"unit\":\"%\"},\"FASAT\":{\"label\":\"Saturated\",\"quantity\":5,\"unit\":\"%\"},\"CHOCDF\":{\"label\":\"Carbs\",\"quantity\":17,\"unit\":\"%\"},\"FIBTG\":{\"label\":\"Fiber\",\"quantity\":0.4000000059604645,\"unit\":\"%\"},\"PROCNT\":{\"label\":\"Protein\",\"quantity\":12,\"unit\":\"%\"},\"CHOLE\":{\"label\":\"Cholesterol\",\"quantity\":2,\"unit\":\"%\"},\"NA\":{\"label\":\"Sodium\",\"quantity\":89.25,\"unit\":\"%\"}},\"ingredients\":[{\"parsed\":[{\"quantity\":1,\"measure\":\"serving\",\"food\":\"Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor\",\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"weight\":68.03885820362122,\"retainedWeight\":68.03885820362122,\"servingSizes\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\",\"quantity\":2.4000000953674316},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\",\"quantity\":70}],\"servingsPerContainer\":1,\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\":\"OK\"}]}]}");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_ax9o3jjbybptbrbzwdbrean5cg4v");

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);
        assertNotNull(data);

        String expected = "Nutritional facts for 'Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor'\n" +
                "\n" +
                "Amount per serving (Weight of 68.04 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 251 kcal\n" +
                "Protein: 6 g\n" +
                "Fat\n" +
                "\tTotal: 3 g\n" +
                "\tSaturated: 1 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 51 g\n" +
                "\tSugars: 3 g\n" +
                "Fiber: 0.1 g\n" +
                "Sodium: 2142 mg\n" +
                "Cholesterol: 6 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 12.55 %\n" +
                "Protein: 12 %\n" +
                "Fat\n" +
                "\tTotal: 4.62 %\n" +
                "\tSaturated: 5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 17 %\n" +
                "Fiber: 0.4 %\n" +
                "Sodium: 89.25 %\n" +
                "Cholesterol: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Gluten, Wheat, Sulfites, Fodmap\n" +
                "\n" +
                "***Health labels***\n" +
                "Egg free, Peanut free, Tree nut free, Soy free, Fish free, Shellfish free,\n" +
                "Pork free, Crustacean free, Celery free, Mustard free, Sesame free, Lupine\n" +
                "free, Mollusk free, Alcohol free\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat\n" +
                "Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup\n" +
                "Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion;\n" +
                "Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce :\n" +
                "Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_ax9o3jjbybptbrbzwdbrean5cg4v\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#a2b21ad2-8a41-4f12-b14c-fff9ca1d1179\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        assertEquals(expected, model.prepareNutritionReportData(data));

    }

    @Test
    public void testGetLinkToUploadedReport() {

        String reportData = "Nutritional facts for 'Vietnamese Pho Rice Noodle Soup, Pho Bo, Beef Flavor'\n" +
                "\n" +
                "Amount per serving (Weight of 68.04 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 251 kcal\n" +
                "Protein: 6 g\n" +
                "Fat\n" +
                "\tTotal: 3 g\n" +
                "\tSaturated: 1 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 51 g\n" +
                "\tSugars: 3 g\n" +
                "Fiber: 0.1 g\n" +
                "Sodium: 2142 mg\n" +
                "Cholesterol: 6 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 12.55 %\n" +
                "Protein: 12 %\n" +
                "Fat\n" +
                "\tTotal: 4.62 %\n" +
                "\tSaturated: 5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 17 %\n" +
                "Fiber: 0.4 %\n" +
                "Sodium: 89.25 %\n" +
                "Cholesterol: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Gluten, Wheat, Sulfites, Fodmap\n" +
                "\n" +
                "***Health labels***\n" +
                "Peanut free, Tree nut free, Soy free, Fish free, Shellfish free, Pork free,\n" +
                "Crustacean free, Celery free, Mustard free, Sesame free, Lupine free,\n" +
                "Mollusk free, Alcohol free\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat\n" +
                "Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup\n" +
                "Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion;\n" +
                "Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce :\n" +
                "Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#64178211-b75e-4733-b566-d84fa42f7894\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        lenient().when(imgurApi.uploadNutritionReportToImgur(reportData)).thenReturn("https://i.imgur.com/z8ibd3u.png");
        assertEquals("https://i.imgur.com/z8ibd3u.png", model.uploadNutritionReportAndGetURL(reportData));

    }

    @Test
    public void testPrepareNutritionReportDataForDummyApi() {

        model = new ModelFacadeImpl(foodDummyApi, imgurDummyApi, db, jsonParser, reportParserImpl);

        lenient().when(foodDummyApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_bk6goo7bkb4utbajbrx1lav6e0vm")).thenReturn("{\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\",\"calories\" : 140,\"totalWeight\" : 28.0,\"dietLabels\" : [ ],\"healthLabels\" : [ \"VEGETARIAN\", \"PESCATARIAN\", \"GLUTEN_FREE\", \"WHEAT_FREE\", \"EGG_FREE\", \"TREE_NUT_FREE\", \"FISH_FREE\", \"SHELLFISH_FREE\", \"PORK_FREE\", \"RED_MEAT_FREE\", \"CRUSTACEAN_FREE\", \"CELERY_FREE\", \"MUSTARD_FREE\", \"SESAME_FREE\", \"LUPINE_FREE\", \"MOLLUSK_FREE\", \"ALCOHOL_FREE\", \"KOSHER\" ],\"cautions\" : [ \"SULFITES\" ],\"totalNutrients\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 140.0,\"unit\" : \"kcal\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 9.000000000000002,\"unit\" : \"g\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 1.5000000000000002,\"unit\" : \"g\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 16.000000000000004,\"unit\" : \"g\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"SUGAR\" : {\"label\" : \"Sugars\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 2.0000000000000004,\"unit\" : \"g\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"mg\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 240.00000000000006,\"unit\" : \"mg\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 20.000000000000004,\"unit\" : \"mg\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 0.3600000143051148,\"unit\" : \"mg\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 4.800000190734864,\"unit\" : \"mg\"}},\"totalDaily\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 7.0,\"unit\" : \"%\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 13.84615384615385,\"unit\" : \"%\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 7.500000000000002,\"unit\" : \"%\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 5.333333333333335,\"unit\" : \"%\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"%\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 10.000000000000004,\"unit\" : \"%\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 2.0000000000000004,\"unit\" : \"%\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 2.0000000794728603,\"unit\" : \"%\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 5.3333335452609605,\"unit\" : \"%\"}},\"ingredients\" : [ {\"parsed\" : [ {\"quantity\" : 1.0,\"measure\" : \"serving\",\"food\" : \"Doritos - Jacked Test Flavor - 2 Blue\",\"foodId\" : \"food_bk6goo7bkb4utbajbrx1lav6e0vm\",\"foodContentsLabel\" : \"Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt; Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures; Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey; Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate And Guanylate.\",\"weight\" : 28.0,\"retainedWeight\" : 28.0,\"servingSizes\" : [ {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\" : \"Gram\",\"quantity\" : 28.0}, {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_chip\",\"label\" : \"Chip\",\"quantity\" : 13.0} ],\"servingsPerContainer\" : 1.0,\"measureURI\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\" : \"OK\"} ]} ]}\n");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_bk6goo7bkb4utbajbrx1lav6e0vm");


        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);
        assertNotNull(data);


        String expectedReportData = "Nutritional facts for 'Doritos - Jacked Test Flavor - 2 Blue'\n" +
                "\n" +
                "Amount per serving (Weight of 28 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 140 kcal\n" +
                "Protein: 2 g\n" +
                "Fat\n" +
                "\tTotal: 9 g\n" +
                "\tSaturated: 1.5 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 16 g\n" +
                "\tSugars: 1 g\n" +
                "Fiber: 1 g\n" +
                "Sodium: 240 mg\n" +
                "Cholesterol: 0 mg\n" +
                "Vitamin C: 4.8 mg\n" +
                "Calcium: 20 mg\n" +
                "Iron: 0.36 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 7 %\n" +
                "Protein: 4 %\n" +
                "Fat\n" +
                "\tTotal: 13.85 %\n" +
                "\tSaturated: 7.5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 5.33 %\n" +
                "Fiber: 4 %\n" +
                "Sodium: 10 %\n" +
                "Cholesterol: 0 %\n" +
                "Vitamin C: 5.33 %\n" +
                "Calcium: 2 %\n" +
                "Iron: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Sulfites\n" +
                "\n" +
                "***Health labels***\n" +
                "Vegetarian, Pescatarian, Gluten free, Wheat free, Egg free, Tree nut free,\n" +
                "Fish free, Shellfish free, Pork free, Red meat free, Crustacean free,\n" +
                "Celery free, Mustard free, Sesame free, Lupine free, Mollusk free, Alcohol\n" +
                "free, Kosher\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt;\n" +
                "Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures;\n" +
                "Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey;\n" +
                "Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate\n" +
                "And Guanylate.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_bk6goo7bkb4utbajbrx1lav6e0vm\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        assertEquals(expectedReportData, model.prepareNutritionReportData(data));

    }

    @Test
    public void testGetLinkToUploadedQRCodeForDummyApi() {

        model = new ModelFacadeImpl(foodDummyApi, imgurDummyApi, db, jsonParser, reportParserImpl);

        String expectedReportData = "Nutritional facts for 'Doritos - Jacked Test Flavor - 2 Blue'\n" +
                "\n" +
                "Amount per serving (Weight of 28 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 140 kcal\n" +
                "Protein: 2 g\n" +
                "Fat\n" +
                "\tTotal: 9 g\n" +
                "\tSaturated: 1.5 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 16 g\n" +
                "\tSugars: 1 g\n" +
                "Fiber: 1 g\n" +
                "Sodium: 240 mg\n" +
                "Cholesterol: 0 mg\n" +
                "Vitamin C: 4.8 mg\n" +
                "Calcium: 20 mg\n" +
                "Iron: 0.36 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 7 %\n" +
                "Protein: 4 %\n" +
                "Fat\n" +
                "\tTotal: 13.85 %\n" +
                "\tSaturated: 7.5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 5.33 %\n" +
                "Fiber: 4 %\n" +
                "Sodium: 10 %\n" +
                "Cholesterol: 0 %\n" +
                "Vitamin C: 5.33 %\n" +
                "Calcium: 2 %\n" +
                "Iron: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Sulfites\n" +
                "\n" +
                "***Health labels***\n" +
                "Vegetarian, Pescatarian, Gluten free, Wheat free, Egg free, Tree nut free,\n" +
                "Fish free, Shellfish free, Pork free, Red meat free, Crustacean free,\n" +
                "Celery free, Mustard free, Sesame free, Lupine free, Mollusk free, Alcohol\n" +
                "free, Kosher\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt;\n" +
                "Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures;\n" +
                "Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey;\n" +
                "Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate\n" +
                "And Guanylate.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#3b2b7ef6-cf16-450c-a4b0-2e2220aeb281\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        lenient().when(imgurDummyApi.uploadNutritionReportToImgur(expectedReportData)).thenReturn("https://i.imgur.com/GsPX46C.png");
        assertEquals("https://i.imgur.com/GsPX46C.png", model.uploadNutritionReportAndGetURL(expectedReportData));

    }

    @Test
    public void testPrepareNutritionalReportWithUnusualData() {

        model = new ModelFacadeImpl(foodDummyApi, imgurDummyApi, db, jsonParser, reportParserImpl);

        lenient().when(foodDummyApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_bk6goo7bkb4utbajbrx1lav6e0vm")).thenReturn("{\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\",\"calories\" : 140,\"totalWeight\" : 28.0,\"dietLabels\" : [ ],\"healthLabels\" : [ \"VEGETARIAN\", \"PESCATARIAN\", \"GLUTEN_FREE\", \"WHEAT_FREE\", \"EGG_FREE\", \"TREE_NUT_FREE\", \"FISH_FREE\", \"SHELLFISH_FREE\", \"PORK_FREE\", \"RED_MEAT_FREE\", \"CRUSTACEAN_FREE\", \"CELERY_FREE\", \"MUSTARD_FREE\", \"SESAME_FREE\", \"LUPINE_FREE\", \"MOLLUSK_FREE\", \"ALCOHOL_FREE\", \"KOSHER\" ],\"cautions\" : [ \"SULFITES\" ],\"totalNutrients\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 140.0,\"unit\" : \"kcal\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 9.000000000000002,\"unit\" : \"g\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 1.5000000000000002,\"unit\" : \"g\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 16.000000000000004,\"unit\" : \"g\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"SUGAR\" : {\"label\" : \"Sugars\",\"quantity\" : 1.0000000000000002,\"unit\" : \"g\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 2.0000000000000004,\"unit\" : \"g\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"mg\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 240.00000000000006,\"unit\" : \"mg\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 20.000000000000004,\"unit\" : \"mg\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 0.3600000143051148,\"unit\" : \"mg\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 4.800000190734864,\"unit\" : \"mg\"}},\"totalDaily\" : {\"ENERC_KCAL\" : {\"label\" : \"Energy\",\"quantity\" : 7.0,\"unit\" : \"%\"},\"FAT\" : {\"label\" : \"Fat\",\"quantity\" : 13.84615384615385,\"unit\" : \"%\"},\"FASAT\" : {\"label\" : \"Saturated\",\"quantity\" : 7.500000000000002,\"unit\" : \"%\"},\"CHOCDF\" : {\"label\" : \"Carbs\",\"quantity\" : 5.333333333333335,\"unit\" : \"%\"},\"FIBTG\" : {\"label\" : \"Fiber\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"PROCNT\" : {\"label\" : \"Protein\",\"quantity\" : 4.000000000000001,\"unit\" : \"%\"},\"CHOLE\" : {\"label\" : \"Cholesterol\",\"quantity\" : 0.0,\"unit\" : \"%\"},\"NA\" : {\"label\" : \"Sodium\",\"quantity\" : 10.000000000000004,\"unit\" : \"%\"},\"CA\" : {\"label\" : \"Calcium\",\"quantity\" : 2.0000000000000004,\"unit\" : \"%\"},\"FE\" : {\"label\" : \"Iron\",\"quantity\" : 2.0000000794728603,\"unit\" : \"%\"},\"VITC\" : {\"label\" : \"Vitamin C\",\"quantity\" : 5.3333335452609605,\"unit\" : \"%\"}},\"ingredients\" : [ {\"parsed\" : [ {\"quantity\" : 1.0,\"measure\" : \"serving\",\"food\" : \"Doritos - Jacked Test Flavor - 2 Blue\",\"foodId\" : \"food_bk6goo7bkb4utbajbrx1lav6e0vm\",\"foodContentsLabel\" : \"Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt; Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures; Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey; Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate And Guanylate.\",\"weight\" : 28.0,\"retainedWeight\" : 28.0,\"servingSizes\" : [ {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\" : \"Gram\",\"quantity\" : 28.0}, {\"uri\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_chip\",\"label\" : \"Chip\",\"quantity\" : 13.0} ],\"servingsPerContainer\" : 1.0,\"measureURI\" : \"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"status\" : \"OK\"} ]} ]}\n");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_bk6goo7bkb4utbajbrx1lav6e0vm");

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);

        String e1 = "Nutritional facts for 'Doritos - Jacked Test Flavor - 2 Blue'\n" +
                "\n" +
                "Amount per serving (Weight of 28 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "Energy: 140 kcal\n" +
                "Protein: 2 g\n" +
                "Fat\n" +
                "\tTotal: 9 g\n" +
                "\tSaturated: 1.5 g\n" +
                "Carbohydrate\n" +
                "\tTotal: 16 g\n" +
                "\tSugars: 1 g\n" +
                "Fiber: 1 g\n" +
                "Sodium: 240 mg\n" +
                "Cholesterol: 0 mg\n" +
                "Vitamin C: 4.8 mg\n" +
                "Calcium: 20 mg\n" +
                "Iron: 0.36 mg\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "Energy: 7 %\n" +
                "Protein: 4 %\n" +
                "Fat\n" +
                "\tTotal: 13.85 %\n" +
                "\tSaturated: 7.5 %\n" +
                "Carbohydrate\n" +
                "\tTotal: 5.33 %\n" +
                "Fiber: 4 %\n" +
                "Sodium: 10 %\n" +
                "Cholesterol: 0 %\n" +
                "Vitamin C: 5.33 %\n" +
                "Calcium: 2 %\n" +
                "Iron: 2 %\n" +
                "\n" +
                "***Cautions***\n" +
                "Sulfites\n" +
                "\n" +
                "***Health labels***\n" +
                "Vegetarian, Pescatarian, Gluten free, Wheat free, Egg free, Tree nut free,\n" +
                "Fish free, Shellfish free, Pork free, Red meat free, Crustacean free,\n" +
                "Celery free, Mustard free, Sesame free, Lupine free, Mollusk free, Alcohol\n" +
                "free, Kosher\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt;\n" +
                "Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures;\n" +
                "Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey;\n" +
                "Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate\n" +
                "And Guanylate.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_bk6goo7bkb4utbajbrx1lav6e0vm\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        assertEquals(e1, model.prepareNutritionReportData(data));


        data.setDietLabels(new ArrayList<>());
        data.setHealthLabels(new ArrayList<>());
        data.setCautions(new ArrayList<>());
        data.setTotalNutrients(new ArrayList<>());
        data.setDailyNutrients(new ArrayList<>());

        String e2 = "Nutritional facts for 'Doritos - Jacked Test Flavor - 2 Blue'\n" +
                "\n" +
                "Amount per serving (Weight of 28 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "N/A\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "N/A\n" +
                "\n" +
                "***Cautions***\n" +
                "N/A\n" +
                "\n" +
                "***Health labels***\n" +
                "N/A\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "Potatoes; Vegetable Oil ( Peanut Oil; Corn Oil; Sunflower Oil ); Salt;\n" +
                "Monterey Jack; Blue And Cheddar Cheese ( Pasteurized Milk; Cheese Cultures;\n" +
                "Salt; Enzymes ); Maltodextrin; Partially Hydrogenated Soybean Oil; Whey;\n" +
                "Spices; Nonfat Dry Milk; Citric Acid; Natural Flavor; Disodium Inosinate\n" +
                "And Guanylate.\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: food_bk6goo7bkb4utbajbrx1lav6e0vm\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#9823095b-3615-4843-b4c9-9ef21ab7e8bd\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_serving\n" +
                "Food URI: N/A\n" +
                "Glycemic index: N/A";

        assertEquals(e2, model.prepareNutritionReportData(data));

    }

    @Test
    public void testParseShorterNutritionData() {

        lenient().when(foodApi.foodSearchRequest("pho bo")).thenReturn("{\"text\":\"pho bo\",\"parsed\":[]," +
                "\"hints\":[{\"food\":{\"foodId\":\"food_aqbqwiabyu8z3na7wx75yadbpbuv\",\"label\":\"Pho bo, Vietnamese Beef Noodle Soup Recipes\",\"nutrients\":{\"ENERC_KCAL\":118.5878310328453,\"PROCNT\":5.660732600854679,\"FAT\":8.579647168640978,\"CHOCDF\":4.407222110668033,\"FIBTG\":0.25267015516000774},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef short ribs; water; star anise; cinnamon stick; cloves; black peppercorns; ginger; onions; stewing beef; fish sauce; Salt; rice noodles; bean sprouts; lean beef; basil; coriander leaves; shallots; serrano chiles; lime\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_ax9o3jjbybptbrbzwdbrean5cg4v\",\"label\":\"Vietnamese Pho Rice Noodle Soup, Pho bo, Beef Flavor\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\",\"image\":\"https://www.edamam.com/food-img/f92/f929fad67cc61733dccb46dae7a1e4c1.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_br8zzy9b0pupd5acnhv29aiiroai\",\"label\":\"Vifon - Vietnamese Pho bo Beef Flavor Rice Noodle Soup\",\"nutrients\":{\"ENERC_KCAL\":368.9068373969877,\"PROCNT\":8.818490136979786,\"FAT\":4.409245068489893,\"CHOCDF\":74.95716616432819,\"FIBTG\":0.1469748378064255},\"brand\":\"Vietnam Food Industries Joint Stock Company\",\"category\":\"Packaged foods\",\"categoryLabel\":\"food\",\"foodContentsLabel\":\"Rice Noodle : Rice; Salt; Sugar; Guar Gum. Vegetables Pack : Textured Wheat Gluten; Eryngium; Leek. Oil Pack : Palm Oil; Artificial Beef Flavor. Soup Base : Salt; Sugar; Monosodium Glutamate; Artificial Beef Flavor; Onion; Disodium 5 - Inosinate And Disodium 5 - Guanylate; Caramel. Chili Sauce : Chili; Garlic; Salt; Sugar; Vinegar; Corn Starch.\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_package\",\"label\":\"Package\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_afnegfaaxxs20fa1fxv9ba63s1bl\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":266,\"PROCNT\":26.97,\"FAT\":16.77,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/820/82060c5546b5506157eb10222347addc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b643lm2ab9no7gavlyg5ia9xp383\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":282,\"PROCNT\":25.93,\"FAT\":18.95,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/e56/e5626879784fa813b00f38756e1f3b86.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_butzgzba9cz1ftbl6tvnoaegg8js\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":218,\"PROCNT\":30.32,\"FAT\":9.8,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/9fc/9fc964935fecb04094e072dd291202fc.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_a0jwudwaa9jj7yaa098yqa6tfwu4\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":113,\"PROCNT\":19.15,\"FAT\":3.48,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/178/178221c82a2b82c93433e0c8c66e2242.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_knuckle\",\"label\":\"Knuckle\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"}]},{\"food\":{\"foodId\":\"food_aw94iunbzrlowaa01nlupb4pslrx\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":191,\"PROCNT\":31.54,\"FAT\":6.2,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/cda/cdac66c34acd19e8bcb6fd4119aa9ddb.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bwsm76yamlt954bvsjs9ca33hf5f\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":291,\"PROCNT\":17.32,\"FAT\":24.05,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/5ee/5eef785c09133fb4a4199fda2ff61060.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bg9hn02b2sbwy1btvvp2xbyqqkvh\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":144,\"PROCNT\":19.35,\"FAT\":6.77,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_slice\",\"label\":\"Slice\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_piece\",\"label\":\"Piece\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_shank\",\"label\":\"Shank\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_cutlet\",\"label\":\"Cutlet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_fillet\",\"label\":\"Fillet\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_chop\",\"label\":\"Chop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rump\",\"label\":\"Rump\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_loin\",\"label\":\"Loin\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_roast\",\"label\":\"Roast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_steak\",\"label\":\"Steak\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_scallop\",\"label\":\"Scallop\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_rib\",\"label\":\"Rib\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_medallion\",\"label\":\"Medallion\"}]},{\"food\":{\"foodId\":\"food_bduaejrbd3vj2wb74qeryb9ac11p\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":521,\"PROCNT\":9.4,\"FAT\":53.35,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/3ff/3ff13fd12b11d397fa204469a8dda5fe.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bx60i9ob54yw7gbxaowzvay6fgo3\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":208,\"PROCNT\":17.47,\"FAT\":14.75,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7ee/7eeac59d0cc5263fa9794cccf094db51.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_breast\",\"label\":\"Breast\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_brisket\",\"label\":\"Brisket\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"}]},{\"food\":{\"foodId\":\"food_bxy66nga9w9csxb3vse7vbjasbub\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":248,\"PROCNT\":28.23,\"FAT\":14.16,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/7f9/7f9946fc0b0995390d148d782fb8578f.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_baz1qzvbxlxtzta24ngw9bkpm2eu\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":108,\"PROCNT\":19.28,\"FAT\":2.83,\"CHOCDF\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/058/058d64c5c23a2a3580979815aab2d3ec.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_aidmp07a17eq1za8qu3dvauczx0k\",\"label\":\"Bos Taurus\",\"nutrients\":{\"ENERC_KCAL\":177,\"PROCNT\":32.22,\"FAT\":4.33,\"CHOCDF\":0,\"FIBTG\":0},\"category\":\"Generic foods\",\"categoryLabel\":\"food\",\"image\":\"https://www.edamam.com/food-img/4e3/4e3d2dc9bb0b9819c4c1355409959790.jpg\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\",\"qualified\":[[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#LanguaL_F0014\",\"label\":\"FULLY HEAT-TREATED\"}]]},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_b887gfwbugptp8b4ax7e8bpkc42a\",\"label\":\"Beef Pho\",\"nutrients\":{\"ENERC_KCAL\":72.56406882273347,\"PROCNT\":4.126439591930957,\"FAT\":1.881151653787706,\"CHOCDF\":9.805526808494994,\"FIBTG\":0.6989607423082591},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"piece ginger; garlic; shallot; beef stock; star anise; cinnamon; fish sauce; palm sugar; rice noodles; white onion; beef fillet; black pepper; bean sprouts; chilies; Thai basil; mint leaves\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bkxmwwebwo95dna0j5mv0bxkstqc\",\"label\":\"Faux Pho\",\"nutrients\":{\"ENERC_KCAL\":69.73453580183781,\"PROCNT\":4.009046642202151,\"FAT\":1.9768611062005457,\"CHOCDF\":8.97026883740962,\"FIBTG\":0.6699134516278402},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"rice sticks; snow peas; vegetable oil; shallots; ginger; serrano chile; beef stock; broth; water; rare roast beef; bean sprouts; cilantro; fresh basil; mint; fish sauce; lime juice; salt\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_apzw6q8azq6ujpapw661gbndrmcz\",\"label\":\"Turkey Pho\",\"nutrients\":{\"ENERC_KCAL\":130.88091049835262,\"PROCNT\":4.38362581696519,\"FAT\":1.6862862928418778,\"CHOCDF\":24.42057572396058,\"FIBTG\":0.7628931247321398},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"coriander seeds; cloves; star anise; cinnamon stick; turkey stock; green onions; ginger; brown sugar; fish sauce; kale; turkey breast; bean thread noodles; lime; Sriracha\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bh5twobasevqefb2rf12bb2xq810\",\"label\":\"Vietnamese Pho\",\"nutrients\":{\"ENERC_KCAL\":67.46051231305492,\"PROCNT\":3.5483275815495334,\"FAT\":1.1407679506189536,\"CHOCDF\":10.639879708017723,\"FIBTG\":0.5158907952835058},\"category\":\"Generic meals\",\"categoryLabel\":\"meal\",\"foodContentsLabel\":\"beef stock; onion; ginger; cloves; black peppercorns; cinnamon stick; beef sirloin steak; hoisin sauce; fish sauce; red chillies; spring onions; fresh coriander; lime; rice noodles\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"label\":\"Whole\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]},{\"food\":{\"foodId\":\"food_bfdmpupbzn2n6gadmplhab75x7w3\",\"label\":\"Pho\",\"nutrients\":{\"ENERC_KCAL\":112.28533685601057,\"PROCNT\":4.227212681638045,\"FAT\":0.7926023778071335,\"CHOCDF\":22.324966974900928,\"FIBTG\":0.7926023778071335},\"brand\":\"Earl's\",\"category\":\"Fast foods\",\"categoryLabel\":\"meal\"},\"measures\":[{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_serving\",\"label\":\"Serving\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_gram\",\"label\":\"Gram\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_ounce\",\"label\":\"Ounce\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_pound\",\"label\":\"Pound\"},{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_kilogram\",\"label\":\"Kilogram\"}]}],\"_links\":{\"next\":{\"title\":\"Next page\",\"href\":\"https://api.edamam.com/api/food-database/parser?session=40&app_id=5c8fcc57&app_key=8f2e80cbb28dfcb8ed8b9411d42426eb&ingr=pho+bo\"}}}");

        lenient().when(foodApi.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                ".owl#Measure_serving", "food_ax9o3jjbybptbrbzwdbrean5cg4v")).thenReturn("{\"uri\":\"http://www.edamam.com/ontologies/edamam.owl#6cabde74-6a45-4da5-b100-f4138a587484\",\"yield\":1,\"calories\":22,\"glycemicIndex\":38,\"totalWeight\":123,\"dietLabels\":[\"LOW_FAT\",\"LOW_SODIUM\",\"...\"],\"healthLabels\":[\"FAT_FREE\",\"VEGAN\",\"...\"],\"cautions\":[],\"totalNutrients\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":22.14,\"unit\":\"kcal\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":0.246,\"unit\":\"g\"},\"...\":{}},\"totalDaily\":{\"ENERC_KCAL\":{\"label\":\"Energy\",\"quantity\":1.107,\"unit\":\"%\"},\"FAT\":{\"label\":\"Fat\",\"quantity\":0.37846153846153846,\"unit\":\"%\"},\"...\":{}},\"ingredients\":[{\"parsed\":[{\"quantity\":1,\"measure\":\"whole\",\"food\":\"Tomatoes, red, ripe, raw, year round average\",\"foodId\":\"Food_11529\",\"foodURI\":\"http://www.edamam.com/ontologies/edamam.owl#Food_11529\",\"weight\":123,\"retainedWeight\":123,\"measureURI\":\"http://www.edamam.com/ontologies/edamam.owl#Measure_unit\",\"status\":\"OK\"}]}]}");

        String apiResponse = model.foodNutritionSearchRequest("http://www.edamam.com/ontologies/edamam" +
                        ".owl#Measure_serving",
                "food_ax9o3jjbybptbrbzwdbrean5cg4v");

        FoodItemNutrientData data = model.getFoodItemNutrientData(apiResponse);
        assertNotNull(data);

        String expected = "Nutritional facts for 'Tomatoes, Red, Ripe, Raw, Year Round Average'\n" +
                "\n" +
                "Amount per whole (Weight of 123 g)\n" +
                "\n" +
                "***Total nutrients***\n" +
                "N/A\n" +
                "\n" +
                "***Daily nutrients***\n" +
                "N/A\n" +
                "\n" +
                "***Cautions***\n" +
                "N/A\n" +
                "\n" +
                "***Health labels***\n" +
                "N/A\n" +
                "\n" +
                "***Diet labels***\n" +
                "N/A\n" +
                "\n" +
                "***Ingredients***\n" +
                "N/A\n" +
                "\n" +
                "***Miscellaneous***\n" +
                "Food ID: Food_11529\n" +
                "Nutrition URI: http://www.edamam.com/ontologies/edamam.owl#6cabde74-6a45-4da5-b100-f4138a587484\n" +
                "Measure URI: http://www.edamam.com/ontologies/edamam.owl#Measure_unit\n" +
                "Food URI: http://www.edamam.com/ontologies/edamam.owl#Food_11529\n" +
                "Glycemic index: 38";


        assertEquals(expected, model.prepareNutritionReportData(data));

    }



}
